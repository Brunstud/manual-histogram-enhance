# å›¾åƒå¢å¼ºåˆ†ææŠ¥å‘Š

## ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

æœ¬é¡¹ç›®æ—¨åœ¨å¯¹ ImageNet æ•°æ®é›†ä¸­çš„å›¾åƒè¿›è¡Œ**äº®åº¦å¢å¼ºå¤„ç†**ï¼Œé€šè¿‡è®¾è®¡åˆç†çš„æ’å€¼ä¸å¯¹æ¯”åº¦å¢å¼ºç®—æ³•ï¼Œä½¿å›¾åƒåœ¨ä¿æŒè‰²å½©è‡ªç„¶çš„å‰æä¸‹è·å¾—æ›´æ¸…æ™°ã€å¯è¯†åˆ«çš„äº®åº¦ç»“æ„ï¼Œæå‡å›¾åƒå¯¹æ¯”åº¦ã€å±‚æ¬¡æ„Ÿä¸ç»†èŠ‚è¡¨ç°ï¼Œä¸ºåç»­è®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼ˆå¦‚åˆ†ç±»ã€æ£€æµ‹ï¼‰æä¾›è´¨é‡æ›´é«˜çš„è¾“å…¥æ•°æ®ã€‚

## äºŒã€å›¾åƒæ•°æ®é›†ä¸æ ¼å¼åˆ†æ

### å›¾åƒæ¥æºä¸ç»Ÿè®¡

* æœ¬é¡¹ç›®ä½¿ç”¨äº† ImageNet ä¸­çš„ä¸‰ä¸ªç±»ç›®ï¼š

  * ğŸ± çŒ«ç±»ï¼ˆn02123045ï¼‰ï¼š1525 å¼ ï¼Œå¹³å‡å°ºå¯¸çº¦ 429Ã—429
    ![](./img/n02123045.png)
  * ğŸ­ è€é¼ ç±»ï¼ˆn02352591ï¼‰ï¼š654 å¼ ï¼Œå¹³å‡å°ºå¯¸çº¦ 317Ã—317
    ![](./img/n02352591.png)
  * ğŸšœ æ‹–æ‹‰æœºç±»ï¼ˆn04465501ï¼‰ï¼š1726 å¼ ï¼Œå¹³å‡å°ºå¯¸çº¦ 500Ã—500
    ![](./img/n04465501.png)
* **æ€»ä½“ç»Ÿè®¡**ï¼š
  ![](./img/img_sizes.png)

  * æ€»å›¾åƒæ•°ï¼š3905 å¼ 
  * æœ€å°å°ºå¯¸ï¼š50Ã—44ï¼Œæœ€å¤§å°ºå¯¸ï¼š3504Ã—2336
  * å¹³å‡é¢ç§¯ï¼š199334.8ï¼Œ
  * æ¨è resize å°ºå¯¸ä¸ºï¼š446Ã—446ï¼ˆå¹³æ–¹å‡å€¼é¢ç§¯å¼€æ–¹æ‰€å¾—ï¼‰

> å»ºè®®ä»¥å¹³å‡é¢ç§¯å¼€æ–¹åçš„ç­‰æ•ˆå°ºå¯¸ä½œä¸ºç¼©æ”¾æ ‡å‡†ï¼Œä»¥æœ€å¤§è¦†ç›–å›¾åƒç»†èŠ‚å¹¶å…¼é¡¾æ•ˆç‡ã€‚
> ![](./img/cal_resize_size.png)

### å›¾åƒæ ¼å¼ä¸ç¼–ç ï¼ˆJPEGï¼‰

JPEG æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å›¾åƒå‹ç¼©æ ¼å¼ï¼Œé‡‡ç”¨æœ‰æŸå‹ç¼©æ–¹å¼ï¼Œåœ¨ä¿æŒå¯æ¥å—çš„å›¾åƒè´¨é‡çš„åŒæ—¶å¤§å¹…å‡å°æ–‡ä»¶ä½“ç§¯ã€‚å…¶å‹ç¼©æµç¨‹ä¸»è¦åŒ…æ‹¬ï¼š

1. **é¢œè‰²ç©ºé—´è½¬æ¢**ï¼šå°†å›¾åƒä» RGB è½¬æ¢ä¸º YCbCrã€‚è¯¥è¿‡ç¨‹å°†å›¾åƒæ‹†åˆ†ä¸ºäº®åº¦é€šé“ Y å’Œä¸¤ä¸ªè‰²åº¦é€šé“ Cbã€Crã€‚äººçœ¼å¯¹äº®åº¦æ›´æ•æ„Ÿï¼Œå› æ­¤å‹ç¼©æ—¶ä¼˜å…ˆä¿ç•™ Y é€šé“çš„ä¿¡æ¯ã€‚
2. **è‰²åº¦å­é‡‡æ ·**ï¼šé€šå¸¸é‡‡ç”¨ 4:2:0 æˆ– 4:2:2 æ ¼å¼ï¼Œå¯¹ Cb/Cr åˆ†é‡è¿›è¡Œä¸‹é‡‡æ ·ã€‚
3. **DCTï¼ˆç¦»æ•£ä½™å¼¦å˜æ¢ï¼‰**ï¼šå°†å›¾åƒåˆ†å—ï¼ˆå¦‚ 8x8ï¼‰å¹¶è½¬æ¢åˆ°é¢‘åŸŸï¼Œå¯¹é«˜é¢‘ä¿¡æ¯è¿›è¡Œå‹ç¼©ã€‚
4. **é‡åŒ–ä¸ç†µç¼–ç **ï¼šæ ¹æ®é‡åŒ–è¡¨å¯¹é¢‘ç‡ç³»æ•°å‹ç¼©ï¼Œé‡‡ç”¨ Huffman ç¼–ç ç­‰æ–¹å¼è¿›ä¸€æ­¥ç¼–ç å­˜å‚¨ã€‚

> åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œç”±äºå¢å¼ºä¸»è¦é’ˆå¯¹äº®åº¦è¡¨ç°ï¼Œå› æ­¤æ‰€æœ‰æ“ä½œå‡é›†ä¸­åœ¨ Y é€šé“ï¼Œé¿å…å¯¹å‹ç¼©è‰²å½©ç»“æ„é€ æˆå½±å“ã€‚

### è‰²å½©ç©ºé—´è½¬æ¢ï¼šYUV ä¸ RGB

RGB è‰²å½©ç©ºé—´è¡¨è¾¾äº†å›¾åƒçš„ä¸‰ç§åŸºæœ¬é¢œè‰²é€šé“ï¼Œé€‚åˆäºå›¾åƒæ˜¾ç¤ºå’Œç¼–è¾‘ï¼›
![](./img/RGB1.png) ![](./img/RGB2.png)
è€Œ YUVï¼ˆæˆ– YCbCrï¼‰åˆ™æ˜¯å°†å›¾åƒåˆ†ä¸ºäº®åº¦ï¼ˆYï¼‰å’Œè‰²åº¦ï¼ˆU/V æˆ– Cb/Crï¼‰ä¸¤éƒ¨åˆ†ï¼Œæ›´ç¬¦åˆäººçœ¼æ„ŸçŸ¥ç‰¹æ€§ï¼Œå› æ­¤ JPEG ç¼–ç å’Œå›¾åƒå¢å¼ºå¸¸åœ¨ YUV ç©ºé—´ä¸­è¿›è¡Œã€‚
![](./img/YUV1.png)
![](./img/YUV2.png)

è½¬æ¢è¿‡ç¨‹ï¼š
![](./img/RGB-YUV.png)

* RGB â†’ YCbCrï¼šæå–äº®åº¦ä¿¡æ¯ï¼Œå‹ç¼©å‰é¢„å¤„ç†
* YCbCr â†’ RGBï¼šå¢å¼ºå®Œæˆåé‡å»ºå½©è‰²å›¾åƒ

å…¶ä¸­è½¬æ¢æ ¸å¿ƒåœ¨äºï¼š

* Y é€šé“åŠ æƒç»„åˆäº† RGBï¼Œåæ˜ äº®åº¦
* Cb å’Œ Cr åˆ†åˆ«åæ˜ è“è‰²å·®å’Œçº¢è‰²å·®

è½¬æ¢é€»è¾‘èƒŒåæ˜¯äººçœ¼è§†è§‰ç³»ç»Ÿå¯¹æ˜æš—ï¼ˆäº®åº¦ï¼‰æ›´åŠ æ•æ„Ÿï¼Œå¯¹é¢œè‰²ï¼ˆè‰²å·®ï¼‰ç›¸å¯¹å®½å®¹ï¼Œä»è€Œæ”¯æ’‘ JPEG åœ¨ Y é€šé“ä¸Šé«˜ä¿çœŸå‹ç¼©ã€è‰²å½©é€šé“ä½ç²¾åº¦å¤„ç†çš„ç­–ç•¥ã€‚

## ä¸‰ã€Resize ç­–ç•¥åˆ†æ

### ä¸ºä»€ä¹ˆè¦ Resizeï¼Ÿ

* åŸå§‹å›¾åƒå°ºå¯¸å·®å¼‚è¿‡å¤§ï¼Œä¸åˆ©äºæ‰¹é‡å¤„ç†å’Œè§†è§‰å¯¹æ¯”
* ç»Ÿä¸€å°ºå¯¸å¯ä½¿å¢å¼ºæ–¹æ³•å¯¹æ‰€æœ‰å›¾åƒå‡æœ‰æ•ˆ
* åç»­æ¨¡å‹è®­ç»ƒæˆ–åˆ†æä»»åŠ¡ä¹Ÿé€šå¸¸è¦æ±‚è¾“å…¥å°ºå¯¸ä¸€è‡´

### æ–¹æ³•å¯¹æ¯”ä¸åŸç†åˆ†æ

| æ–¹æ³•       | åŸç†                   | ç‰¹æ€§ä¸è¡¨ç°         |
| ---------- | ---------------------- | ------------------ |
| æœ€è¿‘é‚»æ’å€¼ | å–æœ€æ¥è¿‘çš„åƒç´          | å¿«é€Ÿä½†è¾¹ç¼˜é”¯é½¿æ˜æ˜¾ |
| åŒçº¿æ€§æ’å€¼ | å››ä¸ªåƒç´ æŒ‰è·ç¦»åŠ æƒå¹³å‡ | æ›´å¹³æ»‘ã€è§†è§‰æ•ˆæœä½³ |

#### æœ€è¿‘é‚»æ’å€¼è¯¦è§£ï¼š

![](./img/nearest.png)
ç›®æ ‡å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ ç‚¹ï¼Œæ ¹æ®æ¯”ä¾‹æ˜ å°„å›åŸå›¾ï¼Œç›´æ¥å–æœ€è¿‘çš„åƒç´ ä½œä¸ºè¾“å‡ºã€‚è¯¥æ–¹æ³•å®ç°ç®€å•ã€è¿ç®—é‡ä½ï¼Œéå¸¸é€‚åˆå®æ—¶å¤„ç†ã€‚ä½†å› ä¸ºä¸è€ƒè™‘å‘¨å›´åƒç´ å…³ç³»ï¼Œå›¾åƒè¾¹ç¼˜éƒ¨åˆ†å¯èƒ½äº§ç”Ÿâ€œé”¯é½¿æ„Ÿâ€ã€‚

#### åŒçº¿æ€§æ’å€¼è¯¦è§£ï¼š

![](./img/bilinear.png)
åœ¨ç›®æ ‡å›¾åƒæ¯ä¸ªåƒç´ ç‚¹ä¸Šï¼Œæ ¹æ®å…¶æ˜ å°„å›åŸå›¾çš„æµ®ç‚¹ä½ç½®ï¼Œé€‰å–å…¶å‘¨å›´ 2x2 åƒç´ ç‚¹è¿›è¡ŒåŠ æƒå¹³å‡ï¼šæƒé‡ç”±ä¸ç›®æ ‡ç‚¹çš„è·ç¦»å†³å®šï¼Œè¶Šè¿‘æƒé‡è¶Šå¤§ã€‚è¿™ç§æ–¹å¼å¯ä»¥è®©å›¾åƒè¾¹ç¼˜æ›´å¹³æ»‘ï¼Œå‡å°‘è§†è§‰çªå˜ï¼Œæ˜¯å›¾åƒå¢å¼ºä¸å›¾åƒç¼–è¾‘çš„å¸¸ç”¨æ–¹æ³•ã€‚

> âœ… æœ¬é¡¹ç›®é‡‡ç”¨åŒçº¿æ€§æ’å€¼ä½œä¸ºä¸» Resize ç­–ç•¥ï¼Œåœ¨ä¿è¯å¢å¼ºç®—æ³•ç²¾åº¦çš„åŒæ—¶æé«˜æ•´ä½“å›¾åƒè´¨é‡è¡¨ç°ã€‚

## å››ã€å›¾åƒå¢å¼ºæ–¹æ³•åŸç†ä¸å®ç°

æœ¬é¡¹ç›®é‡‡ç”¨å››ç§åŸºäºäº®åº¦ç›´æ–¹å›¾çš„å›¾åƒå¢å¼ºæŠ€æœ¯ï¼Œåˆ†åˆ«ä¸ºï¼šå…¨å±€ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼ˆequalizeï¼‰ã€è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼ˆCLAHEï¼‰ã€çº¿æ€§å¯¹æ¯”åº¦æ‹‰ä¼¸ï¼ˆstretchï¼‰ä»¥åŠ Gamma æ ¡æ­£ï¼ˆgammaï¼‰ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡è°ƒæ•´å›¾åƒäº®åº¦åˆ†å¸ƒï¼Œä½¿åƒç´ å€¼æ›´åˆç†åœ°è¦†ç›–åŠ¨æ€èŒƒå›´ï¼ˆ0\~255ï¼‰ï¼Œä»è€Œæå‡å›¾åƒçš„å¯¹æ¯”åº¦å’Œå¯è§†ç»†èŠ‚ã€‚

ç»Ÿä¸€å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š

1. åŸå§‹ RGB å›¾åƒ â†’ YCrCb è‰²å½©ç©ºé—´è½¬æ¢ï¼ˆåˆ†ç¦»äº®åº¦ä¸è‰²å½©ï¼‰
2. å¯¹ Yï¼ˆäº®åº¦ï¼‰é€šé“ä½¿ç”¨æŒ‡å®šå¢å¼ºæ–¹æ³•è¿›è¡Œå¢å¼º
3. å°†å¢å¼ºåçš„ Y é€šé“ä¸åŸ Cr/Cb åˆå¹¶ï¼Œå†è½¬å› RGB æ ¼å¼ç”Ÿæˆå¢å¼ºå›¾åƒ

### æ–¹æ³•å¯¹æ¯”ä¸æ•°å­¦åŸç†

#### 1. å…¨å±€ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼ˆequalizeï¼‰

åŸºäºç´¯è®¡åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰å¯¹åƒç´ å€¼éçº¿æ€§é‡æ˜ å°„ï¼š

$$
C(i) = \sum_{j=0}^i h(j) \quad (\text{ç´¯è®¡ç›´æ–¹å›¾})
$$

$$
x' = \text{round} \left( \frac{C(x) - C_{\text{min}}}{N - C_{\text{min}}} \times 255 \right)
$$

è¯¥æ–¹æ³•å¯¹æ•´ä¸ªå›¾åƒçš„ç°åº¦ç›´æ–¹å›¾è¿›è¡Œå‡è¡¡å¤„ç†ã€‚é¦–å…ˆç»Ÿè®¡å‡ºåƒç´ å€¼åœ¨ \[0, 255] èŒƒå›´å†…çš„åˆ†å¸ƒé¢‘ç‡ï¼Œæ„é€ ç´¯è®¡åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ï¼Œå†ç”¨è¯¥å‡½æ•°å°†åŸå§‹åƒç´ å€¼éçº¿æ€§åœ°æ˜ å°„åˆ°æ–°çš„ç°åº¦ç©ºé—´ä¸­ï¼Œä½¿å¾—å›¾åƒæ•´ä½“å¯¹æ¯”åº¦æå‡ã€‚

å¢å¼ºç»“æœå¯¹ä½äº®åŒºåŸŸå°¤å…¶æ˜æ˜¾ï¼Œé€‚åˆå¤„ç†æ›å…‰ä¸è¶³çš„å›¾åƒã€‚

> | åŸå›¾                                                      | æ‰‹åŠ¨å¢å¼º                                                | cv2å¢å¼ºå›¾                                              | ç›´æ–¹å›¾                                                                  |
> | --------------------------------------------------------- | ------------------------------------------------------- | ------------------------------------------------------ | ----------------------------------------------------------------------- |
> | ![](./data/extracted_images/n02123045/n02123045_10001.JPEG) | ![](./data/processed_images/equalize/n02123045_10001.jpg) | ![](./data/demo/n02123045/equalize/n02123045_10001.JPEG) | ![](./data/processed_images/histograms/equalize/n02123045_10001_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10032.JPEG) | ![](./data/processed_images/equalize/n02123045_10032.jpg) | ![](./data/demo/n02123045/equalize/n02123045_10032.JPEG) | ![](./data/processed_images/histograms/equalize/n02123045_10032_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10052.JPEG) | ![](./data/processed_images/equalize/n02123045_10052.jpg) | ![](./data/demo/n02123045/equalize/n02123045_10052.JPEG) | ![](./data/processed_images/histograms/equalize/n02123045_10052_hist.jpg) |

> å›¾ç¤ºï¼šå…¨å±€å‡è¡¡åŒ–åŸç†åŠå…¶ç›´æ–¹å›¾é‡åˆ†å¸ƒè¿‡ç¨‹

#### 2. è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼ˆclaheï¼‰

å°†å›¾åƒåˆ’åˆ†ä¸ºå°å—ï¼Œå¯¹æ¯ä¸ªå—å•ç‹¬æ‰§è¡Œå‡è¡¡åŒ–ï¼Œå¹¶é™åˆ¶å¯¹æ¯”åº¦ï¼ˆclipLimitï¼‰ï¼Œé˜²æ­¢å™ªå£°æ”¾å¤§ã€‚

æ¯ä¸ªå±€éƒ¨å—å†…éƒ¨çš„ç°åº¦æ˜ å°„å‡½æ•°ï¼š

$$
x'_{\text{tile}} = \frac{C_{\text{tile}}(x)}{N_{\text{tile}}} \cdot 255
$$

##### Step 1ï¼šå›¾åƒåˆ’åˆ†ä¸º Tile åŒºåŸŸï¼ˆå¦‚ 8Ã—8ï¼‰

æœ€åˆå°è¯•å°†å›¾åƒç­‰åˆ†æˆ 8Ã—8 å—ï¼Œæ¯å—åˆ†åˆ«æ‰§è¡Œç›´æ–¹å›¾å‡è¡¡ã€‚ä½†å®é™…å›¾åƒå°ºå¯¸å¹¶ä¸æ€»èƒ½è¢« 8 æ•´é™¤ï¼Œå¦‚æœå¼ºè¡Œè£åˆ‡æˆ–æ”¾å¼ƒè¾¹è§’åƒç´ ï¼Œä¼šå¯¼è‡´å›¾åƒå†…å®¹æŸå¤±ã€‚å› æ­¤ï¼š

> è§£å†³æ–¹æ¡ˆï¼š ä¸å›ºå®š tile çš„å®½é«˜ä¸º tile_w = width // tile_sizeï¼Œtile_h = height // tile_sizeï¼Œè€Œæ˜¯å°†æ•´å¼ å›¾åˆ’åˆ†ä¸º 8Ã—8 ä¸ªåŒºåŸŸï¼Œæ¯ä¸ª tile çš„å°ºå¯¸ç”±å›¾åƒå°ºå¯¸è‡ªé€‚åº”è®¡ç®—ï¼Œè¿™æ ·å°±èƒ½å®Œæ•´è¦†ç›–æ•´å¼ å›¾ã€‚
>
> | ä¹‹å‰                  | ä¹‹å                  |
> | --------------------- | --------------------- |
> | ![](./img/clahe_1.jpeg) | ![](./img/clahe_2.jpeg) |

##### Step 2ï¼šå±€éƒ¨å¢å¼ºè¿‡åº¦ï¼Œå™ªå£°ä¸ä¼ªå½±æ”¾å¤§

åŸå§‹å®ç°ä¸­å¯¹æ¯ä¸ª tile æ‰§è¡Œæ ‡å‡†å‡è¡¡åŒ–ï¼Œå¯¼è‡´æš—éƒ¨äº®åº¦è¢«æç«¯æ‹‰é«˜ï¼Œå›¾åƒä¸­æœ¬åº”å¹³æ»‘çš„åŒºåŸŸå‡ºç°å™ªå£°ç”šè‡³ä¼ªè¾¹ç•Œã€‚å‡ºç°è¿™ä¸€é—®é¢˜çš„æ ¹æºæ˜¯ï¼šå°åŒºåŸŸå†…åƒç´ åˆ†å¸ƒé›†ä¸­æ—¶ï¼Œç›´æ–¹å›¾å®¹æ˜“å‡ºç°æŸäº›å¼ºå³°ï¼Œå‡è¡¡åŒ–ä¼šå°†å…¶æ‹‰ä¼¸è‡³æ•´ä¸ªäº®åº¦èŒƒå›´ã€‚

> è§£å†³æ–¹æ¡ˆï¼š å€Ÿé‰´ OpenCV ä¸­ CLAHE çš„è£å‰ªé™åˆ¶ç­–ç•¥ï¼Œå¼•å…¥ clipLimit å‚æ•°ï¼Œå°†æ¯ä¸ªç°åº¦ bin çš„æœ€å¤§é¢‘ç‡é™åˆ¶ä¸º clipLimitï¼Œè¶…è¿‡éƒ¨åˆ†åœ¨æ‰€æœ‰ bin ä¸­å¹³å‡åˆ†æ‘Šï¼Œé˜²æ­¢å±€éƒ¨å¯¹æ¯”åº¦è¿‡é«˜ã€‚

##### Step 3ï¼šTile ä¹‹é—´è¾¹ç¼˜å‡ºç°â€œç¡¬æ‹¼æ¥â€ç—•è¿¹

åœ¨æœ€åˆç‰ˆæœ¬ä¸­ï¼Œå¢å¼ºåçš„å›¾åƒåœ¨ tile è¾¹ç•Œå¤„æ˜æ˜¾å¯è§äº®åº¦ä¸è¿ç»­ï¼Œå‡ºç°æ ¼çŠ¶æ‹¼æ¥ç—•è¿¹ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ª tile å„è‡ªå¢å¼ºåç›´æ¥æ‹¼æ¥ï¼Œè€Œä¸åŒ tile æ‰€ç”¨çš„å‡è¡¡åŒ– LUT å·®å¼‚è¾ƒå¤§ï¼Œå¯¼è‡´äº®åº¦çªå˜ã€‚

> è§£å†³æ–¹æ¡ˆï¼š å€Ÿé‰´å›¾åƒç¼©æ”¾ä¸­çš„åŒçº¿æ€§æ’å€¼æ€æƒ³ï¼Œåœ¨æ¯ä¸ªåƒç´ å¤„æ ¹æ®å…¶ä½äº tile ç½‘æ ¼ä¸­çš„ç›¸å¯¹ä½ç½®ï¼Œä»å…¶å››ä¸ªé‚»åŸŸ tile çš„ LUT ä¸­è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œå®ç°åƒç´ çº§åˆ«çš„å¹³æ»‘è¿‡æ¸¡ï¼ˆç§°ä¸ºâ€œå››é‚»æ’å€¼èåˆâ€ï¼‰ã€‚
>
> | ä¹‹å‰                  | ä¹‹å                  |
> | --------------------- | --------------------- |
> | ![](./img/clahe_2.jpeg) | ![](./img/clahe_3.jpeg) |

CLAHE çš„å®Œæ•´æµç¨‹åŒ…æ‹¬ tile åˆ†å‰²ã€å±€éƒ¨å‡è¡¡ã€é¢‘ç‡é™åˆ¶ã€æ’å€¼èåˆç­‰å¤šä¸ªé˜¶æ®µï¼š
![](./img/clahe.png)

> | åŸå›¾                                                      | æ‰‹åŠ¨å¢å¼º                                             | cv2å¢å¼ºå›¾                                           | ç›´æ–¹å›¾                                                               |
> | --------------------------------------------------------- | ---------------------------------------------------- | --------------------------------------------------- | -------------------------------------------------------------------- |
> | ![](./data/extracted_images/n02123045/n02123045_10001.JPEG) | ![](./data/processed_images/clahe/n02123045_10001.jpg) | ![](./data/demo/n02123045/clahe/n02123045_10001.JPEG) | ![](./data/processed_images/histograms/clahe/n02123045_10001_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10032.JPEG) | ![](./data/processed_images/clahe/n02123045_10032.jpg) | ![](./data/demo/n02123045/clahe/n02123045_10032.JPEG) | ![](./data/processed_images/histograms/clahe/n02123045_10032_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10052.JPEG) | ![](./data/processed_images/clahe/n02123045_10052.jpg) | ![](./data/demo/n02123045/clahe/n02123045_10052.JPEG) | ![](./data/processed_images/histograms/clahe/n02123045_10052_hist.jpg) |

> CLAHE ç®—æ³•å¯¹å›¾åƒå±€éƒ¨åˆ’åˆ†å¹¶èåˆå¢å¼ºï¼Œä¿ç•™æ›´å¤šç»†èŠ‚ï¼Œé¿å…è¿‡åº¦å¯¹æ¯”ã€‚

#### 3. å¯¹æ¯”åº¦æ‹‰ä¼¸ï¼ˆstretchï¼‰

çº¿æ€§å½’ä¸€åŒ–åƒç´ ç°åº¦èŒƒå›´ï¼š

$$
x' = \left( \frac{x - y_{\min}}{y_{\max} - y_{\min}} \right) \cdot 255
$$

è¿™æ˜¯ä¸€ä¸ªçº¿æ€§æ˜ å°„å‡½æ•°ï¼š

$$
f(x) = ax + b, \quad a = \frac{255}{y_{\max} - y_{\min}}, \quad b = -y_{\min} \cdot a
$$

å¯¹æ¯”åº¦æ‹‰ä¼¸æ˜¯ä¸€ç§ç®€å•çš„çº¿æ€§æ˜ å°„æ–¹æ³•ï¼Œå°†å›¾åƒä¸­å®é™…ä½¿ç”¨çš„åƒç´ ç°åº¦åŒºé—´ \[y\_min, y\_max] æ˜ å°„åˆ° \[0, 255]ã€‚

å…¶ä¼˜åŠ¿åœ¨äºå¤„ç†é€Ÿåº¦å¿«ã€ç»“æ„ä¿çœŸæ€§å¥½ï¼Œä½†å¯¹æç«¯åˆ†å¸ƒï¼ˆå¦‚å¤šæ•°åƒç´ é›†ä¸­äºä½ç°åº¦ï¼‰æ”¹å–„èƒ½åŠ›è¾ƒå¼±ã€‚

> | åŸå›¾                                                      | æ‰‹åŠ¨å¢å¼º                                               | cv2å¢å¼ºå›¾                                             | ç›´æ–¹å›¾                                                                 |
> | --------------------------------------------------------- | ------------------------------------------------------ | ----------------------------------------------------- | ---------------------------------------------------------------------- |
> | ![](./data/extracted_images/n02123045/n02123045_10001.JPEG) | ![](./data/processed_images/stretch/n02123045_10001.jpg) | ![](./data/demo/n02123045/stretch/n02123045_10001.JPEG) | ![](./data/processed_images/histograms/stretch/n02123045_10001_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10032.JPEG) | ![](./data/processed_images/stretch/n02123045_10032.jpg) | ![](./data/demo/n02123045/stretch/n02123045_10032.JPEG) | ![](./data/processed_images/histograms/stretch/n02123045_10032_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10052.JPEG) | ![](./data/processed_images/stretch/n02123045_10052.jpg) | ![](./data/demo/n02123045/stretch/n02123045_10052.JPEG) | ![](./data/processed_images/histograms/stretch/n02123045_10052_hist.jpg) |

> å›¾ç¤ºï¼šå°†åŸå§‹ç°åº¦åŒºé—´çº¿æ€§æ‹‰ä¼¸è¦†ç›–æ•´ä¸ªåŠ¨æ€èŒƒå›´ã€‚

#### 4. Gamma æ ¡æ­£ï¼ˆgammaï¼‰

éçº¿æ€§äº®åº¦æ˜ å°„ï¼š

$$
y' = 255 \cdot \left( \frac{y}{255} \right)^\gamma
$$

å½“ \$\gamma < 1\$ æäº®æš—éƒ¨ï¼›\$\gamma > 1\$ å‹ç¼©äº®éƒ¨ã€‚

Gamma æ ¡æ­£æ˜¯ä¸€ç§éçº¿æ€§å˜æ¢ï¼Œç”¨äºè°ƒèŠ‚å›¾åƒäº®åº¦æ„ŸçŸ¥ã€‚é€šè¿‡è°ƒæ•´å‚æ•° gammaï¼Œå¯ä»¥é€‰æ‹©æ€§åœ°æäº®æš—éƒ¨ï¼ˆgamma<1ï¼‰æˆ–å‹ç¼©äº®éƒ¨ï¼ˆgamma>1ï¼‰ã€‚

è¿™ç±»æ–¹æ³•å¸¸ç”¨äºå›¾åƒæ„ŸçŸ¥ç¾åŒ–ã€è§†é¢‘ç¼–ç ç­‰åº”ç”¨ä¸­ï¼Œæä¾›çµæ´»çš„ä¸»è§‚äº®åº¦è°ƒèŠ‚æ‰‹æ®µã€‚

> | åŸå›¾                                                      | æ‰‹åŠ¨å¢å¼º                                             | cv2å¢å¼ºå›¾                                           | ç›´æ–¹å›¾                                                               |
> | --------------------------------------------------------- | ---------------------------------------------------- | --------------------------------------------------- | -------------------------------------------------------------------- |
> | ![](./data/extracted_images/n02123045/n02123045_10001.JPEG) | ![](./data/processed_images/gamma/n02123045_10001.jpg) | ![](./data/demo/n02123045/gamma/n02123045_10001.JPEG) | ![](./data/processed_images/histograms/gamma/n02123045_10001_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10032.JPEG) | ![](./data/processed_images/gamma/n02123045_10032.jpg) | ![](./data/demo/n02123045/gamma/n02123045_10032.JPEG) | ![](./data/processed_images/histograms/gamma/n02123045_10032_hist.jpg) |
> | ![](./data/extracted_images/n02123045/n02123045_10052.JPEG) | ![](./data/processed_images/gamma/n02123045_10052.jpg) | ![](./data/demo/n02123045/gamma/n02123045_10052.JPEG) | ![](./data/processed_images/histograms/gamma/n02123045_10052_hist.jpg) |

> ä¸åŒ gamma ä¸‹çš„æ›²çº¿å˜åŒ–ï¼Œå±•ç¤ºå¯¹å›¾åƒæš—éƒ¨çš„æäº®èƒ½åŠ›ã€‚

### âœ… æŠ€æœ¯ä¼˜åŠ¿ä¸é€‚ç”¨æ€§å¯¹æ¯”

| æ–¹æ³•     | å˜æ¢ç±»å‹   | æ˜¯å¦è‡ªé€‚åº” | ç‰¹ç‚¹                             | é€‚ç”¨åœºæ™¯                   |
| -------- | ---------- | ---------- | -------------------------------- | -------------------------- |
| equalize | éçº¿æ€§å…¨å±€ | å¦         | ç®€å•å¿«é€Ÿï¼Œæ‹‰ä¼¸é›†ä¸­äº®åº¦           | æ™®é€šå›¾åƒã€å¯¹æ¯”åº¦åä½å›¾åƒ   |
| clahe    | éçº¿æ€§å±€éƒ¨ | æ˜¯         | ä¿ç•™ç»†èŠ‚ã€é˜²æ­¢è¿‡åº¦å¢å¼º           | åŒ»å­¦å›¾åƒã€å¤œæ™¯ã€äººè„¸å¢å¼º   |
| stretch  | çº¿æ€§å…¨å±€   | å¦         | ä¿æ¯”ä¾‹ã€ä¸å¼•å…¥éçº¿æ€§å¤±çœŸ         | å›¾åƒç°åº¦èŒƒå›´çª„ä½†æ— åæš—åŒºåŸŸ |
| gamma    | éçº¿æ€§å…¨å±€ | å¦         | å¯è°ƒäº®åº¦æ›²çº¿ï¼Œæš—éƒ¨æäº®æˆ–äº®éƒ¨å‹æš— | å…‰ç…§è¡¥å¿ã€æ„ŸçŸ¥è°ƒæ•´         |

## äº”ã€å¢å¼ºæ•ˆæœå¯¹æ¯”ç¤ºä¾‹

### ğŸ± çŒ«ç±»ï¼ˆn02123045ï¼‰

![](./data/extracted_images/n02123045/n02123045_9.JPEG)

| å¢å¼ºæ–¹æ³• | å¢å¼ºåå›¾åƒ                                         | å¢å¼ºå‰åç›´æ–¹å›¾                                          |
| -------- | -------------------------------------------------- | ------------------------------------------------------- |
| Equalize | ![](./data/demo/n02123045/equalize/n02123045_9.JPEG) | ![](./data/demo/histograms/equalize/n02123045_9_hist.png) |
| Clahe    | ![](./data/demo/n02123045/clahe/n02123045_9.JPEG)    | ![](./data/demo/histograms/clahe/n02123045_9_hist.png)    |
| Stretch  | ![](./data/demo/n02123045/stretch/n02123045_9.JPEG)  | ![](./data/demo/histograms/stretch/n02123045_9_hist.png)  |
| Gamma    | ![](./data/demo/n02123045/gamma/n02123045_9.JPEG)    | ![](./data/demo/histograms/gamma/n02123045_9_hist.png)    |

### ğŸ­ è€é¼ ç±»ï¼ˆn02352591ï¼‰

![](./data/extracted_images/n02352591/n02352591_49.JPEG)

| å¢å¼ºæ–¹æ³• | å¢å¼ºåå›¾åƒ                                          | å¢å¼ºå‰åç›´æ–¹å›¾                                           |
| -------- | --------------------------------------------------- | -------------------------------------------------------- |
| Equalize | ![](./data/demo/n02352591/equalize/n02352591_49.JPEG) | ![](./data/demo/histograms/equalize/n02352591_49_hist.png) |
| Clahe    | ![](./data/demo/n02352591/clahe/n02352591_49.JPEG)    | ![](./data/demo/histograms/clahe/n02352591_49_hist.png)    |
| Stretch  | ![](./data/demo/n02352591/stretch/n02352591_49.JPEG)  | ![](./data/demo/histograms/stretch/n02352591_49_hist.png)  |
| Gamma    | ![](./data/demo/n02352591/gamma/n02352591_49.JPEG)    | ![](./data/demo/histograms/gamma/n02352591_49_hist.png)    |

### ğŸšœ æ‹–æ‹‰æœºç±»ï¼ˆn04465501ï¼‰

![](./data/extracted_images/n04465501/n04465501_109.JPEG)

| å¢å¼ºæ–¹æ³• | å¢å¼ºåå›¾åƒ                                           | å¢å¼ºå‰åç›´æ–¹å›¾                                            |
| -------- | ---------------------------------------------------- | --------------------------------------------------------- |
| Equalize | ![](./data/demo/n04465501/equalize/n04465501_109.JPEG) | ![](./data/demo/histograms/equalize/n04465501_109_hist.png) |
| Clahe    | ![](./data/demo/n04465501/clahe/n04465501_109.JPEG)    | ![](./data/demo/histograms/clahe/n04465501_109_hist.png)    |
| Stretch  | ![](./data/demo/n04465501/stretch/n04465501_109.JPEG)  | ![](./data/demo/histograms/stretch/n04465501_109_hist.png)  |
| Gamma    | ![](./data/demo/n04465501/gamma/n04465501_109.JPEG)    | ![](./data/demo/histograms/gamma/n04465501_109_hist.png)    |

## å…­ã€ç»Ÿè®¡ä¸å¯¹æ¯”ç»“æœ

| ç±»åˆ«   | åŸå›¾æ•°é‡ | æœ‰æ•ˆå¢å¼ºå›¾æ•°é‡ | å¢å¼ºåå¹³å‡äº®åº¦æå‡ï¼ˆä¸»è§‚ï¼‰ |
| ------ | -------- | -------------- | -------------------------- |
| çŒ«     | 1525 å¼   | 1525Â å¼        | ä¸­ç­‰åé«˜                   |
| è€é¼    | 654 å¼    | 654 å¼          | é«˜ï¼ŒåŸå›¾æ™®éåæš—           |
| æ‹–æ‹‰æœº | 1726 å¼   | 1726 å¼         | é«˜ï¼Œé€†å…‰å’ŒèƒŒå…‰å›¾æ•ˆæœæ˜¾è‘—   |

## ä¸ƒã€å°ç»“ä¸å±•æœ›

æœ¬é¡¹ç›®å®Œæˆäº†ä»æ•°æ®é¢„å¤„ç†ï¼ˆä¸‹è½½ã€è§£å‹ã€Resizeï¼‰åˆ°å››ç§å¢å¼ºæ–¹æ³•çš„ç®—æ³•å®ç°ã€æµ‹è¯•ä¸å¯¹æ¯”ã€‚ä½¿ç”¨çº¯ Python å®ç°äº†ç›´æ–¹å›¾ç»Ÿè®¡ä¸æ’å€¼é€»è¾‘ï¼Œæ·±å…¥æŒæ¡äº†å¢å¼ºç®—æ³•åŸç†ä¸ç»†èŠ‚ã€‚

* `equalize` ç®€æ´é«˜æ•ˆï¼Œé€‚åˆåŸºç¡€å¢å¼ºï¼›
* `clahe` æå‡å±€éƒ¨å¯¹æ¯”åº¦ï¼Œé€‚ç”¨äºç»†èŠ‚æ•æ„Ÿä»»åŠ¡ï¼›
* `stretch` æ›´å¹³æ»‘ã€æ— ä¼ªå½±ï¼Œé€‚ç”¨äºåŠ¨æ€èŒƒå›´ä¸è¶³å›¾åƒï¼›
* `gamma` æä¾›çµæ´»äº®åº¦è°ƒæ§ï¼Œé€‚ç”¨äºä¸»è§‚æ„ŸçŸ¥ä¼˜åŒ–ã€‚
